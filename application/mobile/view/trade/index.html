<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>交易中心</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">
    <link rel="stylesheet" href="/static/mobile/css/weui.min.css">
    <link rel="stylesheet" href="/static/mobile/css/jquery-weui.css">
    <link rel="stylesheet" href="/static/mobile/css/style.css">
    <link rel="stylesheet" href="/static/admin/lib/layui/css/layui.css">
    <script src="/static/admin/lib/layui/layui.js" charset="utf-8"></script>
    <script src="/static/index/js/echarts.min.js"></script>
    <style type="text/css">
    .transaction {
        width: 100%;
    }

    .transaction .tr-header {
        padding: 10px 0;
        /*position: relative;*/
        position: fixed;
        width: 100%;
        background: #0e1227;
        z-index: 9999;
    }

    .tr-header .tr-mo {
        text-align: center;

    }

    .tr-header .goback {
        width: 25px;
        position: absolute;
        left: 15px;
        top: 5px;
    }

    .tr-mo span {
        font-weight: bold;
        font-size: 13px;
        color: white;

    }

    .tr-mo img {
        width: 19px;
    }

    .k-trtext {

        padding: 10px;
        padding-top: 50px;
        padding-bottom: 0;
    }

    .k-trtext:after,
    .k-trtext .ktr-lr p:after,
    .k-min ul:after,
    .footer ul:after,
    .model .m-h2:after,
    .ar-tit ul:after,
    .ar-text>div:after,
    .moe:after{
        content: "";
        display: block;
        clear: both;
    }

    .k-trtext > div {
        width: 50%;
        float: left;
    }

    .ktr-lf .lf-h1 span {
        font-size: 17px;
        color: #3fc85a;
        margin-right: 10px;
    }

    .ktr-lf .lf-h1 img {
        width: 17px;
    }

    .ktr-lf .lf-h1, .lf-h2 {
        height:23px;
    }

    .lf-h2 p {
        font-size: 12px;
        color: #5b5d66;

    }

    .lf-h2 p small {
        color: #3fc85a;
        font-size: 12px;
    }

    .k-trtext .ktr-lr p {
        height: 20px;
        font-size: 12px;
    }

    .k-trtext .ktr-lr p > span {
        float: left;
        width: 50%;
        display: block;
        font-size: 12px;
        color: #5b5d66;
    }

    .k-trtext .ktr-lr p span:last-child {
        text-align: right;
        color: white;
    }

    .k-min {
        padding: 5px 0;
        background: #1d1d33;

    }

    .k-min ul {
        width: 100%;
        overflow-x: scroll;
        white-space: nowrap;
    }

    .k-min ul li {
        color: #434a5e;
        font-size: 13px;
        width: 16%;
        display: inline-block;
        text-align: center;
    }

    .order .order-tit {
        width: 100%;
        padding: 8px;
        background: #0e1227;
    }

    .order-tit p {
        text-align: center;
        color: white;
        font-size: 13px;
    }

    .order-list {
        width: 100%;
        height: 200px;
        overflow-y: scroll;
        padding-bottom: 40px;
    }

    .order table {
        width: 100%;
    }

    .order table tr {
        padding: 4px 0;
    }

    .order table tr:first-child {
        background: black;
        position: absolute;
        margin-top: -2px;
        width: 100%;
        top: 576px;
    }

    .order table tr th {
        display: block;
        float: left;
        width: 20%;
    }

    .order table tr th, .order table tr td {
        width: 20%;
        text-align: center;
        font-size: 13px;
        padding: 10px 0;
    }

    .order table tr th {
        color: white;
    }

    .order table tr td {
        color: #ff5e5e;
    }

    .order table tr:nth-child(2n) td {
        color: #2f8e4a;
    }

    .order table tr:nth-child(2) th{
        padding-top: 46px;
    }

    .footer {
        position: fixed;
        width: 100%;
        bottom: 0;
        left: 0;
    }

    .footer ul li {
        width: 50%;
        float: left;
        padding: 10px 0;
        font-size: 14px;
        color: white;
        text-align: center;
    }

    .footer ul li:first-child {
        background: #40cc5b;
    }

    .footer ul li:last-child {
        background: #ff5e5e;
    }

    .layui-input-block {
        margin-left: 0;
        float: left;
        width: 65px;
    }
    .m-h2  input.chosecon{
        float: left;
        display: none;
    }
    .m-hang p{
        font-size: 13px;
        color: white;
        height: 25px;
        line-height: 20px;
    }

    .headar .model-content{
        bottom: inherit;
        top:22px;
        background: #23233d;
        padding-bottom: 0;
    }
    .ar-tit{
        width: 100%;
    }
    .ar-tit ul li{
        padding: 10px 0;
        width: 33.33%;
        float: left;
        text-align: center;
        color: white;
        font-size: 13px;
    }
    .ar-tit ul li.active{
        border-top: 2px solid #0c89de;
        color: #0c89de;
    }
    .ar-text{
        padding: 0 10px;
    }
    .ar-text>div p{
        /*padding: 6px 0;*/
        font-size: 13px;
        color: white;
        width: 33.33%;
        text-align: center;
        float: left;
        height: 35px;
        line-height: 35px;
    }
    .ar-text .txt{
        border-bottom: 1px solid white;
    }
    .ar-text>div p:first-child{
        text-align: left;
    }
    .ar-text div p span{
        width: 100%;
        display: block;
        height: 1rem;
        line-height:2rem;
    }
    .ar-text div p span:last-child,.ar-text .txt1 p{
        color: #656570;
    }
    .ar-text .txt1{
        border-bottom: 1px dashed #fff;
        border-top: 1px dashed #fff;
    }
    .ar-text .txt:last-child{
        border-bottom: 0;
    }
    .addbill .model-content .m-hang{
        margin-bottom: 3px;
    }
    .addbill .model-content{
        padding: 10px;
    }
    .addbill  .model-content h2{
        margin-bottom: 5px;
    }
    .moe{
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
    }
    .moe p{
        font-size: 12px;
        color: #fff;
        width: 33.33%;
        float: left;
        text-align: center;
    }
    .txt p small{
        font-size: 13px;
    }
    .k-xian{
        position: relative;
    }
    .k-min ul li{
        color: white;
    }
    .my_active{
        background-color: orange;
    }
    </style>
</head>
<body ontouchstart>
<!--顶部搜索-->
<!--主体-->
<div class='weui-content'>
    <div class="transaction">
        <div class="tr-header">
            <img src="/static/mobile/images/xiayibuer.png" class="goback" onclick="window.location.href='/mobile/Index/price'"/>
            <div class="tr-mo">
                <span class="product_name" id="active_product_name" data-abbreviation="{$product.abbreviation}">{$product.desc_name}</span>
                <img src="/static/mobile/images/xiamore.png"/>
            </div>

        </div>
        <div class="k-trtext">
            <div class="ktr-lf">
                <div class="lf-h1">
                    <span class="now_price">0.00</span>
                    <!--<img src="/static/mobile/images/upup.png"/>-->
                </div>
                <div class="lf-h2">
                    <p style="color: white">
                        <small><span class="up_down_per">0.00</span>%</small>
                        =￥ <span class="up_down_val">0.00</span>
                    </p>
                </div>
            </div>
            <div class="ktr-lr">
                <p>
                    <span style="color: white">高 <span id="high">0.00</span></span>
                    <span>开 <span id="open">0.00</span></span>
                </p>
                <p>
                    <span style="color: white">低 <span class="low">0.00</span></span>
                    <span style="color: white">收 <span class="close">0.00</span></span>
                </p>
               
            </div>
        </div>
        <div class="k-min">
            <ul >
                <li gap="1minute">1分钟</li>
                <li gap="5minute">5分钟</li>
                <li gap="15minute">15分钟</li>
                <li gap="30minute">30分钟</li>
                <li gap="60minute">1小时</li>
                <li class="my_active default_active" gap="1day" count="30">1天</li>
            </ul>
        </div>
        <div class="k-xian">
            <div id="main" style="width: 100%;height:420px;"></div>
            <div class="moe">
            	<p>账户余额： <span id="user_money">{$user.money|number_format=###,2,'.',''}</span>  </p>
            	<p>保证金：<span id="user_promise_money">{$user.promise_money|number_format=###,2,'.',''}</span></p>
            	<p>可用余额：<span id="user_real_money">{$user.real_money|number_format=###,2,'.',''}</span></p>
            </div>
        </div>
        <div class="order">
            <div class="order-tit">
                <p>持仓订单</p>
            </div>
            <div class="order-list">
                <table class="order_add_list">
                    <tr>
                        <th>产品</th>
                        <th>买入价</th>
                        <th>当前价</th>
                        <th>收益</th>
                        <th>操作</th>
                    </tr>
                    {volist name="keep_order_list" id="val"}
                    <tr class="{$val.oid} keep_order_list">
                        <th>{$val.product_name}</th>
                        <th class="buy_price">{$val['buy_price']|number_format=###,2,'.',''}</th>
                        <th class="now_price_{$val.product_abbreviation} list_now_price">0.00</th>
                        <th class="profit">0.00</th>
                        <th><button style="background-color: red;color: white;border-radius:8%;width: 3rem;" onclick="close_order({$val.oid})">平仓</button></th>
                        <input type="hidden" value="{$val['direction']}" class="o_direction"/>
                        <input type="hidden" value="{$val['contract']}" class="o_contract"/>
                        <input type="hidden" value="{$val['hand']}" class="o_hand"/>
                    </tr>
                    {/volist}

                </table>
            </div>


        </div>
    </div>
</div>
<div class="model headar">
    <div class="model-content">
        <!--<div class="ar-tit">-->
            <!--<ul>-->
                <!--<li class="active">合约区</li>-->
                <!--<li>主币区</li>-->
                <!--<li>通证区</li>-->
            <!--</ul>-->
        <!--</div>-->
        <div class="ar-text">
            <div class="txt1">
                <p>产品类型</p>
                <p>当前价格</p>
                <p>涨跌</p>
            </div>
            {volist name="product_list" id="val"}
            <div class="txt" data-abbreviation="{$val.abbreviation}">
                <input type="hidden" id="{$val.abbreviation}_id" value="{$val.id}"/>
                <input type="hidden" id="{$val.abbreviation}_contract" value="{$val.contract|number_format=###,2,'.',''}"/>
                <input type="hidden" id="{$val.abbreviation}_min_hand" value="{$val.min_hand|number_format=###,2,'.',''}"/>
                <input type="hidden" id="{$val.abbreviation}_fee" value="{$val.fee|number_format=###,2,'.',''}"/>
                <input type="hidden" id="{$val.abbreviation}_wave" value="{$val.wave}"/>
                <p class="desc_name ">{$val.desc_name}</p>
                <p>
                    <span class="now_price_{$val.abbreviation} l color_{$val.abbreviation}">0.00</span>
                </p>
                <p>
                    <small class="up_down_val_{$val.abbreviation} val">0.00</small> / <small class="up_down_per_{$val.abbreviation} per">0.00</small>%
                </p>
            </div>
            {/volist}
        </div>
    </div>
</div>
<div class="model addbill">
    <div class="model-content">
        <h2 class="m-title">
            新建订单
        </h2>
        <form action="" class="layui-form">
            <div class="m-hang">
                <label>品种</label>
                <input type="text" readonly="readonly" value="{$product.desc_name}" class="order_product_name" />
            </div>
            <div class="m-hang">
                <label>当前价格</label>
                <input type="text" readonly="readonly" value="0.00" class="order_price" />
            </div>
            <div class="m-hang">
                <label>交易单位</label>
                <input type="text" readonly="readonly" class="order_min_hand" value="{$product.min_hand|number_format=###,2,'.',''}" />
            </div>
            <div class="m-hang">
                <label>合约比例</label>
                <input type="text" readonly="readonly" class="order_contract" value="{$product.contract|number_format=###,2,'.',''}" />
            </div>
            <div class="m-hang">
                <label>方向</label>
                <input type="text" readonly="readonly" class="order_direction" value="买入" />
            </div>
            <div class="m-hang">
                <label>手数</label>
                <input type="number" value="0" class="shosu" name="hand" />
            </div>
            <div class="m-hang">
                <label>保证金</label>
                <input type="text" readonly="readonly" value="0" class="promise_money"/>
            </div>
            <div class="m-hang">
                <label>手续费</label>
                <input type="text" readonly="readonly" class="fee" value="{$product.fee|number_format=###,2,'.',''}" />
            </div>
            <input type="hidden" id="point_wave" value="{$product['wave']}"/>
            <div class="m-hang">
                <p>设置止盈应<span class="win_des">大于</span>等于<span class="target_profit">0.00</span></p>
                <p>设置止损应<span class="loss_des">小于</span>等于<span class="stop_loss">0.00</span></p>
                <div class="m-h2 switchone">
                    <label>止盈</label>
                    <div class="layui-input-block">
                        <input type="checkbox" lay-filter="checks" lay-skin="switch"
                               lay-text="开启|关闭" class="target_profit_check" value="1">
                    </div>
                    <input type="text" style="width: 100px" class="chosecon " name="target_profit"/>
                </div>
                <div class="m-h2 switchtwo">
                    <label>止亏</label>
                    <div class="layui-input-block">
                        <input type="checkbox" lay-filter="checks-t" lay-skin="switch"
                               lay-text="开启|关闭" name="stop_loss_check" value="1">
                    </div>
                    <input type="text" style="width: 100px" class="chosecon " name="stop_loss" />
                </div>
            </div>
            <input type="hidden" name="id" class="form_id" value="{$product['id']}"/>
            <input type="hidden" class="form_direction" name="direction" value="1"/>
            <div class="m-hang" style="margin-top:20px;">
                <button style="background-color: orange;color: white" class="create_order submit" type="button">确定</button>
                <button class="cancel" type="button">取消</button>
            </div>

        </form>

    </div>
</div>
<div class="footer">
    <ul>
        <li onclick="set_direction('买入',1)">
            买入
        </li>
        <li onclick="set_direction('卖出',2)">
            卖出
        </li>
    </ul>
</div>

</body>
</html>
<script src="/static/index/js/jquery-2.1.1.min.js"></script>
<script src="/static/admin/lib/layui/layui.js" charset="utf-8"></script>
<script type="text/javascript" src="/static/admin/js/xadmin.js"></script>
<script>

var myChart = echarts.init(document.getElementById('main'));
var rawData = [["2015/1/5", "3258.63", "3350.52", "115.84", "3.58%", "3253.88", "3369.28", "531352384", "54976008", "-"], ["2015/1/6", "3330.8", "3351.45", "0.93", "0.03%", "3303.18", "3394.22", "501661696", "53239848", "-"], ["2015/1/7", "3326.65", "3373.95", "22.51", "0.67%", "3312.21", "3374.9", "391918880", "43641672", "-"], ["2015/1/8", "3371.96", "3293.46", "-80.5", "-2.39%", "3285.09", "3381.57", "371131200", "39923032", "-"], ["2015/1/9", "3276.97", "3285.41", "-8.04", "-0.24%", "3267.51", "3404.83", "410240864", "45864804", "-"], ["2015/1/12", "3258.21", "3229.32", "-56.1", "-1.71%", "3191.58", "3275.19", "322064672", "36627308", "-"], ["2015/1/13", "3223.54", "3235.3", "5.98", "0.19%", "3214.41", "3259.39", "230725760", "27358878", "-"], ["2015/1/14", "3242.34", "3222.44", "-12.86", "-0.40%", "3193.98", "3268.48", "240190752", "26720452", "-"], ["2015/1/15", "3224.07", "3336.46", "114.02", "3.54%", "3207.54", "3337.08", "282546240", "33061054", "-"], ["2015/1/16", "3343.6", "3376.5", "40.04", "1.20%", "3340.49", "3400.32", "339876768", "39225388", "-"], ["2015/1/19", "3189.73", "3116.35", "-260.14", "-7.70%", "3095.07", "3262.21", "401098784", "40988600", "-"], ["2015/1/20", "3114.56", "3173.05", "56.7", "1.82%", "3100.48", "3190.25", "357080800", "41629524", "-"], ["2015/1/21", "3189.08", "3323.61", "150.56", "4.74%", "3178.34", "3337", "410956032", "47375868", "-"], ["2015/1/22", "3327.32", "3343.34", "19.73", "0.59%", "3293.98", "3352.38", "353382976", "40787408", "-"], ["2015/1/23", "3357.1", "3351.76", "8.42", "0.25%", "3328.29", "3406.79", "366249248", "42097952", "-"], ["2015/1/26", "3347.26", "3383.18", "31.42", "0.94%", "3321.31", "3384.8", "317540992", "35842744", "-"], ["2015/1/27", "3389.85", "3352.96", "-30.22", "-0.89%", "3290.22", "3390.22", "374517568", "41829884", "-"], ["2015/1/28", "3325.72", "3305.74", "-47.22", "-1.41%", "3294.66", "3354.8", "301927104", "34156428", "-"], ["2015/1/29", "3259", "3262.3", "-43.43", "-1.31%", "3234.24", "3286.79", "274658624", "29642450", "-"], ["2015/1/30", "3273.75", "3210.36", "-51.94", "-1.59%", "3210.31", "3288.5", "258312544", "28426564", "-"], ["2015/2/2", "3148.14", "3128.3", "-82.06", "-2.56%", "3122.57", "3175.13", "250861632", "26684996", "-"], ["2015/2/3", "3156.09", "3204.91", "76.61", "2.45%", "3129.73", "3207.94", "248192160", "28335594", "-"], ["2015/2/4", "3212.82", "3174.13", "-30.78", "-0.96%", "3171.14", "3238.98", "249098080", "29015516", "-"], ["2015/2/5", "3251.21", "3136.53", "-37.6", "-1.18%", "3135.82", "3251.21", "306139296", "34826696", "-"], ["2015/2/6", "3120.09", "3075.91", "-60.62", "-1.93%", "3052.94", "3129.54", "246749680", "26650278", "-"], ["2015/2/9", "3063.51", "3095.12", "19.22", "0.62%", "3049.11", "3119.03", "206108384", "24071968", "-"], ["2015/2/10", "3090.49", "3141.59", "46.47", "1.50%", "3084.25", "3142.1", "193817136", "22508492", "-"], ["2015/2/11", "3145.76", "3157.7", "16.11", "0.51%", "3139.05", "3166.42", "172840096", "21086256", "-"], ["2015/2/12", "3157.96", "3173.42", "15.71", "0.50%", "3134.24", "3181.77", "194592320", "22969158", "-"], ["2015/2/13", "3186.81", "3203.83", "30.41", "0.96%", "3182.79", "3237.16", "261290432", "29301768", "-"], ["2015/2/16", "3206.14", "3222.36", "18.54", "0.58%", "3195.88", "3228.85", "223797440", "26595070", "-"], ["2015/2/17", "3230.88", "3246.91", "24.54", "0.76%", "3230.77", "3255.73", "228332624", "26334004", "-"], ["2015/2/25", "3256.48", "3228.84", "-18.06", "-0.56%", "3215.55", "3257.22", "233348096", "26514336", "-"], ["2015/2/26", "3222.15", "3298.36", "69.52", "2.15%", "3202.19", "3300.62", "301263872", "33434746", "-"], ["2015/2/27", "3296.83", "3310.3", "11.94", "0.36%", "3291.01", "3324.55", "299163712", "33501958", "-"], ["2015/3/2", "3332.72", "3336.28", "25.98", "0.78%", "3298.67", "3336.76", "346445664", "41025956", "-"], ["2015/3/3", "3317.7", "3263.05", "-73.23", "-2.20%", "3260.43", "3317.7", "382044608", "44159348", "-"], ["2015/3/4", "3264.18", "3279.53", "16.48", "0.51%", "3250.48", "3286.59", "293639520", "34678976", "-"], ["2015/3/5", "3264.08", "3248.48", "-31.06", "-0.95%", "3221.67", "3266.64", "320663584", "37358000", "-"], ["2015/3/6", "3248.04", "3241.19", "-7.29", "-0.22%", "3234.53", "3266.93", "282915808", "32834414", "-"], ["2015/3/9", "3224.31", "3302.41", "61.22", "1.89%", "3198.37", "3307.7", "321495456", "35992752", "-"], ["2015/3/10", "3289.08", "3286.07", "-16.34", "-0.49%", "3277.09", "3309.92", "285817568", "32995596", "-"], ["2015/3/11", "3289.59", "3290.9", "4.83", "0.15%", "3278.47", "3325.05", "282985536", "32757308", "-"], ["2015/3/12", "3314.81", "3349.32", "58.42", "1.78%", "3300.49", "3360.05", "357295104", "40719240", "-"], ["2015/3/13", "3359.49", "3372.91", "23.59", "0.70%", "3352.15", "3391.25", "328410144", "37404140", "-"], ["2015/3/16", "3391.16", "3449.3", "76.39", "2.26%", "3377.09", "3449.3", "399132416", "47935532", "-"], ["2015/3/17", "3469.6", "3502.85", "53.54", "1.55%", "3459.69", "3504.12", "520939520", "60150068", "-"], ["2015/3/18", "3510.5", "3577.3", "74.45", "2.13%", "3503.85", "3577.66", "545217152", "61736700", "-"], ["2015/3/19", "3576.02", "3582.27", "4.97", "0.14%", "3546.84", "3600.68", "537346624", "61224968", "-"], ["2015/3/20", "3587.08", "3617.32", "35.05", "0.98%", "3569.38", "3632.34", "516661664", "65177196", "-"], ["2015/3/23", "3640.1", "3687.73", "70.41", "1.95%", "3635.49", "3688.25", "536062816", "66157464", "-"], ["2015/3/24", "3692.57", "3691.41", "3.68", "0.10%", "3600.7", "3715.87", "639554688", "75488472", "-"], ["2015/3/25", "3680.95", "3660.73", "-30.68", "-0.83%", "3634.56", "3693.15", "521886336", "64549892", "-"], ["2015/3/26", "3641.94", "3682.09", "21.37", "0.58%", "3615.01", "3707.32", "488647200", "61951560", "-"], ["2015/3/27", "3686.13", "3691.1", "9", "0.24%", "3656.83", "3710.48", "408945184", "50929848", "-"], ["2015/3/30", "3710.61", "3786.57", "95.47", "2.59%", "3710.61", "3795.94", "564702400", "69212536", "-"], ["2015/3/31", "3822.99", "3747.9", "-38.67", "-1.02%", "3737.04", "3835.57", "561676032", "72129488", "-"], ["2015/4/1", "3748.34", "3810.29", "62.4", "1.66%", "3742.21", "3817.08", "447458304", "59241832", "-"], ["2015/4/2", "3827.69", "3825.78", "15.49", "0.41%", "3775.89", "3835.45", "479299680", "63202892", "-"], ["2015/4/3", "3803.38", "3863.93", "38.14", "1.00%", "3792.21", "3864.41", "473033312", "63565136", "-"]];
var colorList = ['#c23531', '#2f4554', '#61a0a8', '#d48265', '#91c7ae', '#749f83', '#ca8622', '#bda29a', '#6e7074', '#546570', '#c4ccd3'];
var labelFont = 'bold 12px Sans-serif';

function calculateMA(dayCount, data) {
    var result = [];
    for (var i = 0, len = data.length; i < len; i++) {
        if (i < dayCount) {
            result.push('-');
            continue;
        }
        var sum = 0;
        for (var j = 0; j < dayCount; j++) {
            sum += data[i - j][1];
        }
        result.push((sum / dayCount).toFixed(2));
    }
    return result;
}


var dates = ["2016-03-29", "2016-03-30", "2016-03-31", "2016-04-01", "2016-04-04", "2016-04-05", "2016-04-06", "2016-04-07", "2016-04-08", "2016-04-11", "2016-04-12", "2016-04-13", "2016-04-14", "2016-04-15", "2016-04-18", "2016-04-19", "2016-04-20", "2016-04-21", "2016-04-22", "2016-04-25", "2016-04-26", "2016-04-27", "2016-04-28", "2016-04-29", "2016-05-02", "2016-05-03", "2016-05-04", "2016-05-05", "2016-05-06", "2016-05-09", "2016-05-10", "2016-05-11", "2016-05-12", "2016-05-13", "2016-05-16", "2016-05-17", "2016-05-18", "2016-05-19", "2016-05-20", "2016-05-23", "2016-05-24", "2016-05-25", "2016-05-26", "2016-05-27", "2016-05-31", "2016-06-01", "2016-06-02", "2016-06-03", "2016-06-06", "2016-06-07", "2016-06-08", "2016-06-09", "2016-06-10", "2016-06-13", "2016-06-14", "2016-06-15", "2016-06-16", "2016-06-17", "2016-06-20", "2016-06-21", "2016-06-22"];
var data = [[17512.58, 17633.11, 17434.27, 17642.81, 86160000], [17652.36, 17716.66, 17652.36, 17790.11, 79330000], [17716.05, 17685.09, 17669.72, 17755.7, 102600000], [17661.74, 17792.75, 17568.02, 17811.48, 104890000], [17799.39, 17737, 17710.67, 17806.38, 85230000], [17718.03, 17603.32, 17579.56, 17718.03, 115230000], [17605.45, 17716.05, 17542.54, 17723.55, 99410000], [17687.28, 17541.96, 17484.23, 17687.28, 90120000], [17555.39, 17576.96, 17528.16, 17694.51, 79990000], [17586.48, 17556.41, 17555.9, 17731.63, 107100000], [17571.34, 17721.25, 17553.57, 17744.43, 81020000], [17741.66, 17908.28, 17741.66, 17918.35, 91710000], [17912.25, 17926.43, 17885.44, 17962.14, 84510000], [17925.95, 17897.46, 17867.41, 17937.65, 118160000], [17890.2, 18004.16, 17848.22, 18009.53, 89390000], [18012.1, 18053.6, 17984.43, 18103.46, 89820000], [18059.49, 18096.27, 18031.21, 18167.63, 100210000], [18092.84, 17982.52, 17963.89, 18107.29, 102720000], [17985.05, 18003.75, 17909.89, 18026.85, 134120000], [17990.94, 17977.24, 17855.55, 17990.94, 83770000], [17987.38, 17990.32, 17934.17, 18043.77, 92570000], [17996.14, 18041.55, 17920.26, 18084.66, 109090000], [18023.88, 17830.76, 17796.55, 18035.73, 100920000], [17813.09, 17773.64, 17651.98, 17814.83, 136670000], [17783.78, 17891.16, 17773.71, 17912.35, 80100000], [17870.75, 17750.91, 17670.88, 17870.75, 97060000], [17735.02, 17651.26, 17609.01, 17738.06, 95020000], [17664.48, 17660.71, 17615.82, 17736.11, 81530000], [17650.3, 17740.63, 17580.38, 17744.54, 80020000], [17743.85, 17705.91, 17668.38, 17783.16, 85590000], [17726.66, 17928.35, 17726.66, 17934.61, 75790000], [17919.03, 17711.12, 17711.05, 17919.03, 87390000], [17711.12, 17720.5, 17625.38, 17798.19, 88560000], [17711.12, 17535.32, 17512.48, 17734.74, 86640000], [17531.76, 17710.71, 17531.76, 17755.8, 88440000], [17701.46, 17529.98, 17469.92, 17701.46, 103260000], [17501.28, 17526.62, 17418.21, 17636.22, 79120000], [17514.16, 17435.4, 17331.07, 17514.16, 95530000], [17437.32, 17500.94, 17437.32, 17571.75, 111990000], [17507.04, 17492.93, 17480.05, 17550.7, 87790000], [17525.19, 17706.05, 17525.19, 17742.59, 86480000], [17735.09, 17851.51, 17735.09, 17891.71, 79180000], [17859.52, 17828.29, 17803.82, 17888.66, 68940000], [17826.85, 17873.22, 17824.73, 17873.22, 73190000], [17891.5, 17787.2, 17724.03, 17899.24, 147390000], [17754.55, 17789.67, 17664.79, 17809.18, 78530000], [17789.05, 17838.56, 17703.55, 17838.56, 75560000], [17799.8, 17807.06, 17689.68, 17833.17, 82270000], [17825.69, 17920.33, 17822.81, 17949.68, 71870000], [17936.22, 17938.28, 17936.22, 18003.23, 78750000], [17931.91, 18005.05, 17931.91, 18016, 71260000], [17969.98, 17985.19, 17915.88, 18005.22, 69690000], [17938.82, 17865.34, 17812.34, 17938.82, 90540000], [17830.5, 17732.48, 17731.35, 17893.28, 101690000], [17710.77, 17674.82, 17595.79, 17733.92, 93740000], [17703.65, 17640.17, 17629.01, 17762.96, 94130000], [17602.23, 17733.1, 17471.29, 17754.91, 91950000], [17733.44, 17675.16, 17602.78, 17733.44, 248680000], [17736.87, 17804.87, 17736.87, 17946.36, 99380000], [17827.33, 17829.73, 17799.8, 17877.84, 85130000], [17832.67, 17780.83, 17770.36, 17920.16, 89440000]];
var volumes = [86160000, 79330000, 102600000, 104890000, 85230000, 115230000, 99410000, 90120000, 79990000, 107100000, 81020000, 91710000, 84510000, 118160000, 89390000, 89820000, 100210000, 102720000, 134120000, 83770000, 92570000, 109090000, 100920000, 136670000, 80100000, 97060000, 95020000, 81530000, 80020000, 85590000, 75790000, 87390000, 88560000, 86640000, 88440000, 103260000, 79120000, 95530000, 111990000, 87790000, 86480000, 79180000, 68940000, 73190000, 147390000, 78530000, 75560000, 82270000, 71870000, 78750000, 71260000, 69690000, 90540000, 101690000, 93740000, 94130000, 91950000, 248680000, 99380000, 85130000, 89440000];

var dataMA5 = calculateMA(5, data);
var dataMA10 = calculateMA(10, data);
var dataMA20 = calculateMA(20, data);


var option = {
    animation: false,
    color: colorList,

    legend: {
        top: 30,
        data: ['日K', 'MA5', 'MA10', 'MA20', 'MA30']
    },
    tooltip: {
        triggerOn: 'none',
        transitionDuration: 0,
        confine: true,
        bordeRadius: 4,
        borderWidth: 1,
        borderColor: '#333',
        backgroundColor: 'rgba(255,255,255,0.9)',
        textStyle: {
            fontSize: 12,
            color: '#333'
        },
        position: function (pos, params, el, elRect, size) {
            var obj = {
                top: 60
            };
            obj[['left', 'right'][+(pos[0] < size.viewSize[0] / 2)]] = 5;
            return obj;
        }
    },
    axisPointer: {
        link: [{
            xAxisIndex: [0, 1]
        }]
    },
    dataZoom: [{
        type: 'slider',
        xAxisIndex: [0, 1],
        realtime: false,
        start: 20,
        end: 70,
        top: 10,
        height: 0,
        handleIcon: 'M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',
        handleSize: '120%'
    }, {
        type: 'inside',
        xAxisIndex: [0, 1],
        start: 40,
        end: 70,
        top: 30,
        height: 20
    }],
    xAxis: [{
        type: 'category',
        data: dates,
        boundaryGap: false,
        axisLine: {lineStyle: {color: '#777'}},
        axisLabel: {
            formatter: function (value) {
                return echarts.format.formatTime('MM-dd', value);
            }
        },
        min: 'dataMin',
        max: 'dataMax',
        axisPointer: {
            show: true
        }
    }, {
        type: 'category',
        gridIndex: 1,
        data: dates,
        scale: true,
        boundaryGap: false,
        splitLine: {show: false},
        axisLabel: {show: false},
        axisTick: {show: false},
        axisLine: {lineStyle: {color: '#777'}},
        splitNumber: 20,
        min: 'dataMin',
        max: 'dataMax',
        axisPointer: {
            type: 'shadow',
            label: {show: false},
            triggerTooltip: true,
            handle: {
                show: false,
                margin: 30,
                color: '#B80C00'
            }
        }
    }],
    yAxis: [{
        scale: true,
        splitNumber: 2,
        axisLine: {lineStyle: {color: '#777'}},
        splitLine: {show: true},
        axisTick: {show: false},
        axisLabel: {
            inside: true,
            formatter: '{value}\n'
        }
    }, {
        scale: true,
        gridIndex: 1,
        splitNumber: 2,
        axisLabel: {show: false},
        axisLine: {show: false},
        axisTick: {show: false},
        splitLine: {show: false}
    }],
    grid: [{
        left: 20,
        right: 20,
        top: 80,
        height: 240
    }, {
        left: 20,
        right: 20,
        height: 40,
        top: 360
    }],
    graphic: [{
        type: 'group',
        left: 'center',
        top: 70,
        width: 300,
        bounding: 'raw',
        children: [{
            id: 'MA5',
            type: 'text',
            style: {fill: colorList[1], font: labelFont},
            left: 0
        }, {
            id: 'MA10',
            type: 'text',
            style: {fill: colorList[2], font: labelFont},
            left: 'center'
        }, {
            id: 'MA20',
            type: 'text',
            style: {fill: colorList[3], font: labelFont},
            right: 0
        }]
    }],
    series: [{
        name: 'Volume',
        type: 'bar',
        xAxisIndex: 1,
        yAxisIndex: 1,
        itemStyle: {
            normal: {
                color: '#7fbe9e'
            },
            emphasis: {
                color: '#140'
            }
        },
        data: volumes
    }, {
        type: 'candlestick',
        name: '日K',
        data: data,
        itemStyle: {
            normal: {
                color: '#ef232a',
                color0: '#14b143',
                borderColor: '#ef232a',
                borderColor0: '#14b143'
            },
            emphasis: {
                color: 'black',
                color0: '#444',
                borderColor: 'black',
                borderColor0: '#444'
            }
        }
    }, {
        name: 'MA5',
        type: 'line',
        data: dataMA5,
        smooth: true,
        showSymbol: false,
        lineStyle: {
            normal: {
                width: 1
            }
        }
    }, {
        name: 'MA10',
        type: 'line',
        data: dataMA10,
        smooth: true,
        showSymbol: false,
        lineStyle: {
            normal: {
                width: 1
            }
        }
    }, {
        name: 'MA20',
        type: 'line',
        data: dataMA20,
        smooth: true,
        showSymbol: false,
        lineStyle: {
            normal: {
                width: 1
            }
        }
    }]
};
myChart.setOption(option);

$(".model .model-content").click(function (e) {
    e.stopPropagation();
});
$(".model").click(function () {
    $(".model").hide();
});
$(".tr-header .tr-mo").click(function () {
    $('.headar').show();
});
$(".ar-tit ul li").click(function(){
    $(this).addClass("active");
    $(this).siblings().removeClass("active");
});

//设置建仓方向
function set_direction(val,number){
    var color;
    if(number==1){
        $('.win_des').text('大于');
        $('.loss_des').text('小于');
        color='red';
    }else{
        $('.win_des').text('小于');
        $('.loss_des').text('大于');
        color='green';
    }
    $('.order_direction').val(val).attr("style","color:"+color+";");
    $('.form_direction').val(number);
    $('.promise_money').val(0.00);
    $(".addbill").show();
    $('.shosu').val('').focus();
}
$(".cancel").click(function () {
    if( $("input[name='target_profit_check']").is(':checked') ){
        $("input[name='target_profit_check']").removeAttr('checked');
        $("input[name='target_profit']").val('');
        $(".switchone .chosecon").hide();
        layui.form.render('checkbox');
    }
    if( $("input[name='stop_loss_check']").is(':checked') ){
        $("input[name='stop_loss_check']").removeAttr('checked');
        $("input[name='stop_loss']").val('');
        $(".switchtwo .chosecon").hide();
        layui.form.render('checkbox');
    }
    $(".model").hide();
});


//手数失焦事件，必须数字，并计算保证金
$(".shosu").blur(function () {
    var vals=$(this).val();
    if(isNotANumber(vals)==true){
        if(vals<0){
            $(".shosu").val(0);
        }else if(vals>0){
            var now_price=$('.order_price').val();
            var contract= $('.order_contract').val();
            var money=now_price*contract*vals/lever;
//                console.log(now_price);
//                console.log(contract);
//                console.log(money);
            $('.promise_money').val(math_floor(money));
        }
    }else{
        $(".shosu").val(0);
    }
});
//切换1min 5min
$('.k-min ul li').click(function(){
    $(this).addClass('my_active').siblings().removeClass('my_active');
    var coinType = $('#active_product_name').attr('data-abbreviation-name');
//    var gap = $(this).attr('gap');
//    setCandlestick(coinType,gap,30);
});
var loc = window.location;
var baseUrl  = loc.protocol  + '//' + loc.host + '/golang'
var openPrice = [];
var lever="{$user.lever}";

function countRange(nowPrice,productAbbreviation,active_name){
    var range=nowPrice-openPrice[productAbbreviation];
    var range_per=range/openPrice[productAbbreviation]*100;
    var up_down_name=  ".up_down_per_"+productAbbreviation;
    var up_down_val_name=  ".up_down_val_"+productAbbreviation;
    var color;
    if(nowPrice>openPrice[productAbbreviation]){
        color='red';
    }else if(nowPrice<openPrice[productAbbreviation]){
        color='green';
    }
    $(up_down_val_name).text(math_floor(range)).attr("style","color:"+color+";");
    $(up_down_name).text(math_floor(range_per)).parent().attr("style","color:"+color+";");
    $('.color_'+productAbbreviation).attr("style","color:"+color+";");
    if(productAbbreviation==active_name){
        $('.now_price').text(nowPrice).attr("style","color:"+color+";");
        $('.order_price').val(nowPrice).attr("style","color:"+color+";");
        $('.up_down_val').text(math_floor(range)).attr("style","color:"+color+";");
        $('.up_down_per').text(math_floor(range_per)).parent().attr("style","color:"+color+";");
    }

}
function handle_money(money,promise_money){
    money=math_floor(money);
    promise_money=math_floor(promise_money);
//        console.log(money);
//        console.log(promise_money);
    var user_money= math_floor($('#user_money').text());
    var user_promise_money= math_floor($('#user_promise_money').text());
    var user_real_money= math_floor($('#user_real_money').text());
    var my_number_money=toRead(x100(user_money)+x100(money));
    var my_promise_money=toRead(x100(user_promise_money)+x100(promise_money));
    var my_real_money=toRead(x100(user_real_money)+x100(money)-x100(promise_money));
    $('#user_money').text(my_number_money);
    $('#user_promise_money').text(my_promise_money);
    $('#user_real_money').text(my_real_money);
}
function count_wave(price){
    var point_wave=$('#point_wave').val();
    var form_direction=$('.form_direction').val();
    if(form_direction==1){
        $('.target_profit').text(math_floor(price-(-point_wave)));
        $('input[name="target_profit"]').val(math_floor(price-(-point_wave)));
        $('.stop_loss').text(math_floor(price-point_wave));
        $('input[name="stop_loss"]').val(math_floor(price-point_wave));
    }else{
        $('.target_profit').text(math_floor(price-point_wave));
        $('input[name="target_profit"]').val(math_floor(price-point_wave));
        $('.stop_loss').text(math_floor(price-(-point_wave)));
        $('input[name="stop_loss"]').val(math_floor(price-(-point_wave)));
    }
    //计算保证金
    var hand=$(".shosu").val();
    if(isNotANumber(hand)==true){
        if(hand<0){
            $(".shosu").val(0);
        }else if(hand>0){
            var now_price=$('.order_price').val();
            var contract= $('.order_contract').val();
            var money=now_price*contract*hand/lever;
            $('.promise_money').val(math_floor(money));
        }
    }
}
//计算持仓单盈亏
function count_profit(){
//        var all=0;
    $('.keep_order_list').each(function(){
        var buy_price=$(this).children('.buy_price').text();
        var now_price=$(this).children('.list_now_price').text();
        if(buy_price==now_price){
            return;
        }
        var direction=$(this).children('.o_direction').val();
        var contract=$(this).children('.o_contract').val();
        var hand=$(this).children('.o_hand').val();
        var amount=(now_price-buy_price)*contract*hand;
        var color;
//            console.log(direction=='买入');
        if(direction==1){
            if(now_price>=buy_price){
                color='red';
            }else if(now_price<buy_price){
                color='green';
            }
        }else{
            if(now_price>=buy_price){
                color='green';
            }else if(now_price<buy_price){
                color='red';
            }
            amount=-amount;
        }
        console.log(amount);
        $(this).children('.profit').text(math_floor(amount)).attr("style","color:"+color+";");
        $(this).children('.list_now_price').attr("style","color:"+color+";");
    });
}
//计算涨幅跌幅

$(".txt").click(function () {
//    $(this).addClass("active");
//    $(this).siblings().removeClass("active");
    $('.default_active').addClass('my_active').siblings().removeClass('my_active');

    //产品名称
    var name= $(this).attr('data-abbreviation');
    //顶部产品属性
    $('#active_product_name').attr('data-abbreviation',name);

    var now_price=$(this).find('.l').text();
    var color= $(this).find('.l').css("color");
    //顶部产品名称
    $('.product_name').text($(this).find('.desc_name').text());
    //建仓产品名称
    $('.order_product_name').val($(this).find('.desc_name').text());

    $('.now_price').text(now_price).attr("style","color:"+color+";");
    $('.order_price').val(now_price).attr("style","color:"+color+";");
    $('.up_down_val').text($(this).find('.val').text()).attr("style","color:"+color+";");
    $('.up_down_per').text($(this).find('.per').text()).parent().attr("style","color:"+color+";");

//    $('.up_down_val').attr('data-product-up-down-val',name);
//    $('.up_down').attr('data-product-up-down',name);

    var form_id='#'+name+'_id';
    var contract_id='#'+name+'_contract';
    var min_hand_id='#'+name+'_min_hand';
    var fee_id='#'+name+'_fee';
    var wave_id='#'+name+'_wave';

    var form_id_val=$(form_id).val();
    var contract_val=$(contract_id).val();
    var min_hand_val=$(min_hand_id).val();
    var fee_val=$(fee_id).val();
    var wave_val=$(wave_id).val();
    $('.order_contract').val(contract_val);
    $('.order_min_hand').val(min_hand_val);
    $('.fee').val(fee_val);
    $('.point_wave').val(wave_val);
    $('.form_id').val(form_id_val);

    $('.target_profit').text(now_price-(-wave_val));
    $('input[name="target_profit"]').val(now_price-(-wave_val));

    $('.stop_loss').text(now_price-wave_val);
    $('input[name="stop_loss"]').val(now_price-wave_val);
    countRange(now_price,name);
    $('.headar').hide();
//                setCandlestick(name,"1day",30);
});

$(function  () {
    var layer;
    var loadingFirst;
    var loadingSecond;
    function prepareWs(){
        var url = baseUrl + "/openPrice";
        url = 'https://aioq.cn/golang/openPrice';
        //获取产品开盘价
        $.ajax({
            type: 'get',
            url: url,
            //async: false,//同步
            success : function(data) {
                for(let i in data){
                    openPrice[i] =data[i]['USD'];
                }
            },
            error : function(errMsg) {
                //不知道该干啥
                layer.msg('网络波动',{icon: 1,time:1000},function(){
                    window.location.href="/mobile/User/index"
                });
            }
        });

        var uid="{$user.uid}";
        var wsUrl ='ws:';
        if(loc.protocol == 'https:')
            wsUrl = 'wss:'
        wsUrl += '//' + loc.host + '/golang/ws?uid=' + uid;
        wsUrl= 'wss://aioq.cn/golang/ws?uid=4';

        var ws = new WebSocket(wsUrl)
//        console.log(wsUrl);
        ws.onopen = function()
        {
            layer.close(loadingFirst);
            loadingSecond = layer.load(2, { //icon支持传入0-2
                shade: [0.5, 'gray'], //0.5透明度的灰色背景
                content: '数据加载中...',
                success: function (layero) {
                    layero.find('.layui-layer-content').css({
                        'padding-top': '39px',
                        'width': '6rem',
                        'color':'white',
                        'font-size':'1rem'

                    });
                }
            });
        };

        ws.onmessage = function (evt)
        {
            var data=JSON.parse(evt.data);
//            console.log(evt);
//            console.log(data);
            if(data.status){
                //总后台强平
                if(data.status==101){
                    layer.msg(data.msg,{icon: 2,time:3000},function(){
                        var tr='.'+data.oid;
                        $(tr).remove();
                        handle_money(data.money,data.promise_money);
                    });
                }
                //爆仓,止盈平仓，止损平仓
                if(data.status==102){
                    layer.msg(data.msg,{icon: 2,time:3000},function(){
                        var tr='.'+data.oid;
                        $(tr).remove();
                        handle_money(data.money,data.promise_money);
                    });
                }
                //资金变化
                if(data.status==201){
                    handle_money(data.money,data.promise_money);
                }
            }else{
                var active_name = $('#active_product_name').attr('data-abbreviation');
                $.each(data,function(k,v){
                    var now_price_class='.now_price_'+k;//固定产品位置
                    var new_price=v['USD'];
                    if(k==active_name){
                        //计算止盈止损
                        count_wave(new_price);
//                            var opt = myChart.getOption();
//                            if(opt){
//                                opt.series[0].markLine.data[0].yAxis = new_price;
//                                myChart.clear();
//                                myChart.setOption(opt);
//                            }
                    }
                    //计算涨幅跌幅
                    countRange(new_price,k,active_name);
                    $(now_price_class).text(new_price);
                });
                //计算持仓单输赢
                count_profit();
                layer.close(loadingSecond);
            }
        };
    }
    layui.use(['layer', 'form'], function () {
        layer = layui.layer;
        var form = layui.form;
        loadingFirst = layer.load(2, { //icon支持传入0-2
            shade: [0.5, 'gray'], //0.5透明度的灰色背景
            content: '连接服务器...',
            success: function (layero) {
                layero.find('.layui-layer-content').css({
                    'padding-top': '39px',
                    'width': '6rem',
                    'color':'white',
                    'font-size':'1rem'

                });
                prepareWs();
            }
        });
        form.on('switch(checks)', function(data){
//                console.log(data.elem.checked); //开关是否开启，true或者false
            if(data.elem.checked==true){
                $(".switchone .chosecon").show();
            }else{
                $(".switchone .chosecon").hide();
            }
        });
        form.on('switch(checks-t)', function(data){
//                console.log(data.elem.checked); //开关是否开启，true或者false
            if(data.elem.checked==true){
                $(".switchtwo .chosecon").show();
            }else{
                $(".switchtwo .chosecon").hide();
            }
        });

        $(".create_order").click(function(event) {
            var hand=$('.shosu').val();
            var id=$('.form_id').val();
            var direction=$('.form_direction').val();
            if(hand<=0){
                layer.msg('请输入正确的手数',{icon: 2,time:1000});
                return false;
            }
            var load = layer.load();
            $(".create_order").attr("disabled",true);
            $.post("/mobile/Trade/create_order",{hand:hand,id:id,direction:direction},function(res){
                layer.close(load);
                $(".create_order").removeAttr("disabled");
                if(res.status==0){
                    layer.msg(res.msg,{icon: 2,time:1000});
                }else{
                    layer.msg(res.msg,{icon: 1,time:1000},function(){
                        keep_order_list_add(res.info);
                        handle_money(-res.info.fee,res.info.money);
                        // window.location.href="/index/User/index"
                    });
                }
            },'json');
            return false;
        });

    });


//        setCandlestick("BTC","1day",30);//1.货币, 2. day,hour,minute 按天，小时，分钟. 3. 几条柱子
});
function close_order(oid){
    layer.confirm('确认要平仓吗？',function(index){
        //发异步删除数据
        var load = layer.load();
        $.ajax({
            url:'/mobile/Trade/close_order',
            data:{oid:oid},
            type:'post',
            dataType:'json',
            success:function(res){
                layer.close(load);
                if(res['status']==1){
                    layer.msg(res['msg'],{icon:1,time:1000},function(){
                        var tr='.'+oid;
                        $(tr).remove();
                        console.log(res);
                        handle_money(res.info.money,res.info.promise_money);
                    });
                }else{
                    layer.msg(res['msg'],{icon: 2,time:1000});
                }
            }
        });
    });
}
function keep_order_list_add(data){
    var html='<tr class="'+data.oid+' keep_order_list">';
    html+='<th>'+data.product_name+'</th>';
    html+='<th class="buy_price">'+math_floor(data.buy_price)+'</th>';
    html+='<th class="list_now_price now_price_'+data.product_abbreviation+'">'+data.now_price+'</th>';
    html+='<th class="profit">0.00</th>';
    html+='<th><button style="background-color: red;color: white;border-radius:8%;width: 3rem;" onclick="close_order('+data.oid+')">平仓</button></th>';
    html+='<input type="hidden" value="'+math_floor(data.direction)+'" class="o_direction"/>';
    html+='<input type="hidden" value="'+math_floor(data.contract)+'" class="o_contract"/>';
    html+='<input type="hidden" value="'+math_floor(data.hand)+'" class="o_hand"/>';
    html+='</tr>';
    $(".order_add_list tr:eq(0)").after(html);
//    $(".order_add_list").prepend(html);
    $(".cancel").click();
}
function math_floor(number,per){
    number = parseFloat(number);
    return number.toFixed(2);
}
function x100(x){
    return Math.floor((+x)*100);
}
function toRead(x){
    x = x + '';
    return x.slice(0,-2) + '.'  + x.slice(-2);
}
function isNotANumber(inputData) {
    //isNaN(inputData)不能判断空串或一个空格
    //如果是一个空串或是一个空格，而isNaN是做为数字0进行处理的，而parseInt与parseFloat是返回一个错误消息，这个isNaN检查不严密而导致的。
    if(parseFloat(inputData).toString() == "NaN") {
        return false;
    } else {
        return true;
    }
}
</script>